\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{bbm}
\usepackage{dsfont}
\usepackage{amsthm}  %Esto sirve para utilizar simbolos
\usepackage{graphicx}
\usepackage{float}
\usepackage{color}
%\usepackage{subfigure}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
%\usepackage{caption}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{todonotes}
%\usepackage{cancel}
\usepackage[english]{babel}
\usepackage{float}
\usepackage{mathtools}
%\usepackage{subfigure} 
\usepackage{subcaption}
\usepackage{comment}
\usepackage{textcomp}
\usepackage{bm}
\usepackage[nobreak=true]{mdframed}	
%\usepackage{minted}
%\usemintedstyle{mathematica}

\usepackage{fancyhdr}
\pagestyle{fancy}

\hypersetup{
    colorlinks=false,
    pdfborder={1 1 0.005},
}

\newcommand{\cA}{\mathcal{A}}
\newcommand{\cS}{\mathcal{S}}
\DeclareMathOperator{\New}{New}
\DeclareMathOperator{\area}{area}
\DeclareMathOperator{\relint}{relint}
\DeclareMathOperator{\vol}{vol}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\def\defs{\stackrel{\tiny{\mbox{def}}}{=}}		% For definitions

\DeclareMathOperator{\conv}{conv}
%\renewcommand{\theenumi}{(\alph{enumi})}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\eps}{\varepsilon}
\theoremstyle{plain}
\newmdtheoremenv[linewidth = 1pt]{result}{Result}
\newtheorem*{theorem*}{Theorem}
\newtheorem{theorem}{Theorem}
\newtheorem{prop}{Proposition}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\theoremstyle{remark}
\newtheorem{fact}{Fact}
\newtheorem{claim}{Claim}
\newtheorem{remark}{Remark}

\theoremstyle{definition}
\newtheorem{definition}{Definition}


\begin{document}
    \thispagestyle{plain}
    \begin{center}
        \rule{\linewidth}{0.05mm}\
        {\Large \textbf{Discrete and Algorithmic Geometry: Sheet 4\\}}
        {\large Ander Elkoroaristizabal Peleteiro \& Filip Cano CÃ³rdoba \& Alberto Larrauri Borroto\\}
        \rule{\linewidth}{0.05mm}\
    \end{center}
    
    \begin{enumerate}
        \item Definition 9.2 in Ziegler's \emph{Lectures on Polytopes} constructs the linear map
        \[
        P
        \ \xrightarrow{\pi^c}\ 
        Q^c :=
        \Big\{ \binom{\pi(x)}{cx} : x\in P\Big\}
        \ \subset \
        \RR^{q+1}
        \]
        from a projection $\pi:P\subset\RR^p\to Q\subset\RR^q$ and a linear function $c\in(\RR^p)^\star$.
        Is it possible to give an algorithm to determine the set of lower faces 
        $\mathcal L^\downarrow(Q^c)$ of $Q^c$ 
        from just the set of facet normals of~$Q$, 
        the projection~$\pi$, and the linear function~$c$, without running a convex hull algorithm on $Q^c$?
        
        \bigskip\bigskip
        \item Show that
        \[
        \int_P f(x)\,\text{d}x
        \ = \
        \vol(P) \cdot f(p_0)
        \]
        for any polytope $P$ and linear function $f$, 
        where $p_0 = \frac{1}{\vol(P)}\int_P x\,\text{d}x$ denotes the barycenter of $P$.
        \bigskip\bigskip
        \item Complete the proof of Theorem 9.6 in Ziegler's \emph{Lectures on Polytopes}, 
        possibly referring to \cite{bs-1992}.
        
    \end{enumerate}
    
    
    \textbf{1.}
    
    It is not possible to give such an algorithm.
    
    This is because $\pi,c$ and the set of facets of $Q$ do not determine the lower faces of $Q^c$.
    Consider $\pi:\RR^2\to \RR$ that deletes the last coordinate. 
    Consdier then $c=(0,1)$. 
    In this case, $\pi^c$ is the identity in $\RR^2$.
    Since in this case $q=1$, the interval is the only polytope the set of facet normals of $q$ is always the same,
    so $q=1$, the only relevant information is $\pi$ and $c$, but in this case, $\pi^c$ is the identity.
    Therefore, it such algorithm existed, the set of lower faces would be the same for all polygons,
    which is not true.
    
    \textbf{2.}
    
    Using the fact that $f$ is linear and linearity of the integral:
    \begin{equation}
    \vol(P) f(p_0)
    = \vol(P) f\left( \frac1{\vol (P)}\int_P x\,\mathrm{d}x \right)
    = f\left(\int_P x\,\mathrm{d}x \right) 
    = \int_P f(x) \,\mathrm{d}x
    \end{equation}
    
    \textbf{3. }
    
    
    %\boxed{\textbf{$\bm{\Sigma(P,Q)}$ is a convex set}}
    \begin{claim}
        \label{clm:convex}
        $\Sigma(P,Q)$ is a convex set.
    \end{claim}
    \begin{proof}
        Consider two points $y_1,y_2 \in \Sigma$,
        and a convex combination of them $y= q_1y_1 + q_2y_2$. 
        Then $y_1 = \int_Q \gamma_1$, $y_2 = \int_Q \gamma_2$ 
        for some $\gamma_1,\gamma_2$ sections. 
        
        Then, by linearity of the integral:
        $y = \int_Q q_1\gamma_1 +q_2\gamma_2$. 
        So we have to see that the convex combination of sections is a section.
        Let $\gamma \defs q_1\gamma_1 +q_2\gamma_2$. 
        Indeed, by linearity of $\pi$:
        \begin{equation}
        \pi(\gamma(x)) = \pi(q_1\gamma_1(x) + q_2\gamma_2(x)) = q_1\pi(\gamma_1(x)) + q_2\pi(\gamma_2(x))
        = (q_1+q_2)x = x
        \end{equation}
    \end{proof}
    % \boxed{\textbf{$\bm{\Sigma(P,Q) \subseteq \pi^{-1}(r_0)}$}}
    
    \begin{claim}
        $\Sigma(P,Q) \subseteq \pi^{-1}(r_0)$.
    \end{claim}
    \begin{proof}
        We want to see that $y\in\Sigma(P,Q) \implies \pi(y) = \bm{r_0}$.
        Consider $y\in \Sigma(P,Q)$. Then there exists $\gamma:Q\to P$ section,
        such that $y =\frac1{\vol(Q)} \int_Q \gamma(x)dx$
        Then:
        \begin{equation}
        \pi(y) = \pi\left(\frac{1}{\vol(Q)} \int_Q \gamma(x)dx\right)
        \end{equation}
        Using linearity of $\pi$ and of the integral, this is equal to
        \footnote{This step probably needs some more explanation. Or maybe not. It's just putting coordinates.}
        \begin{equation}
        \frac{1}{\vol(Q)}\int_Q \pi(\gamma(x))dx 
        = \frac{1}{\vol(Q)}\int_Q xdx 
        = \bm{r_0}
        \end{equation} 	
    \end{proof}
    
    \begin{claim}
        $\mbox{dim}(\Sigma(P,Q)) \leq p-q$.
    \end{claim}
    \begin{proof}
        To prove this, we only need to prove that 
        $\dim \pi^{-1}(\bm{r_0}) = p-q$. For a section to be tight, 
        its corresponding subdivision must be tight as well, 
        because a non-tight subdivision cannot be the image of a section.
        
        Indeed, since $\pi$ is a linear function, 
        $\dim(\pi^{-1}(\bm{r_0})) = \dim \ker(\pi) = p - \dim \mbox{Im} \pi$.
        Since we are assuming that $P$ and $Q$ have full dimension,
        ${\dim\mbox{Im}\pi=q}$.
    \end{proof}
    \begin{remark}
        A section $\gamma:Q\to P$ is uniquely defined by its image $\gamma (Q)$.
    \end{remark}
    \begin{proof}
        Given $x\in Q$, $\gamma(x)$ will be the only element in 
        $\pi^{-1}(x)\cap \gamma(Q)$. 
        This set has exactly one element because $\pi\circ \gamma = \mathrm{id}_Q$.
    \end{proof}
    
    \begin{definition} 
        Given $S\subset \RR^p$ we will call the \emph{direction}
        $\overrightarrow{S}$ of $S$ to the vector subspace of $\RR^p$ 
        spanned by all vectors of the form $x-y$ for some $x,y\in S$. 
    \end{definition}
    
    \begin{lemma}
        Let $v\in \RR^p$. Then the function $f_v: P\leftarrow \RR$ defined by $s\mapsto \max_{s + tv\in P} t$ is continuous. 
    \end{lemma}
    \begin{proof} Note that $f_v$ is indeed well defined: for any $s\in P$ the maximum $t$ does exist.%Don't make me prove this
        \par
        Let $c^1x\leq c^1_0,\dots, c^kx\leq c^k_0$ be the facet-defining inequalities for $P$.
        Then $P$ is the region of points satisfying them all. \par
        Without loss of generality we may assume that the $c^i$'s such that $c^iv>0$ are $c^1,\dots, c^j$.
        Given $s\in P, t\in \RR$ satisfying $s + tv \in P$, 
        there exists an $\eps > 0$ such that $s + (t+ \eps)v\in P$ if and only if 
        $c^i(s+tv) < c^i_0$ for $i\in \{1,\dots, j\}$. %this is a simple computation
        Then, by necessity, $ \max \{t\in \RR \, | \, s + tv\in P\}=
        \max \{ t \in \RR \, | \, c^i(s+tv) \leq c^i_0 \ \ \forall i \in \{1,\dots, j\} =
        min_{1\leq i \leq j} \{\max \{ t \in \RR \,| \, c^i(s+tv)\leq c^i_0\}\}$.
        It is satisfied that $\max \{ t \in \RR \,| \, c^i(s+tv)\leq c^i_0\}=
        \frac{c^i_0-c^is}{c^iv}$ for $1\leq i \leq j$. 
        In consequence $f_v(s)=\min_{1\leq i \leq j} \frac{c^i_0-c^is}{c^iv}$,
        and $f_v$ is the minimum of some finitely many continuous functions.
        Thus, $f_v$ is continuous. 
    \end{proof}
    
    We have the following corollary.
    
    \begin{corollary}
        \label{lem:lemilla}
        Given $s\in  {P}$ and $v\in\RR^p$ such that $s+v\in   P$.
        There exists $U\subseteq   P$, 
        an open set (with the topology of $  P$), $s\in U$,
        and $\eps > 0$ such that $U+\eps v \subseteq   P$.
    \end{corollary}
    
    \begin{lemma} 
        $\dim \Sigma(P,Q) \geq \dim P - \dim Q$
    \end{lemma} 
    \begin{proof}
        \todo[inline]{Still not written. This is the only lemma not yet written.}
    \end{proof}
    
    We still don't know that $\Sigma(P,Q)$ is a polytope. 
    Since we need to talk of its faces, we will make the
    following auxiliary definition.
    
    \begin{definition}
        \label{def:notYetKnownToBeFaces}
        Given a convex set $C\subseteq\RR^p$, a linear function $c\in (\RR^p)^\star$ and a scalar $c_0$,
        we say that $c(y) \leq c_0$ is a \emph{valid inequality} of $C$ it is satisfied in all $y\in C$.
        
        The equality region of a valid inequality of $C$ is a \emph{face}.  
    \end{definition}
    Note that this definition is the same as the one for faces of polytopes,
    but in this case a face may be empty or not a polytope.
    With the inclusion defined partial order, 
    the faces of a convex set have also poset structure.
    This way if the underlying convex set is a polytope, we recover the definition of faces for a polytope.
    
    Let us first note that every element $c\in(\RR^p)^\star$ defines
    both a face in $\Sigma$ and a coherent subdivision in $Q^c$:
    \begin{enumerate}
        \item The face it defines is 
        $\phi^c$, given by the valid inequality 
        $c(s) \geq \min_{y\in \Sigma} c(y)$. 
        \item The coherent subdivision it defines is the one given by
        $\mathcal{F}^c$, as in \cite[Def. 9.2]{ziegler2012lectures}.
    \end{enumerate}
    
    We will see that we can find a bijection between faces of $\Sigma$ and coherent subdivisions of $Q$
    through the elements $c\in(\RR^p)^\star$.
    
    \begin{definition}
        Let $s\in\Sigma$, then
        \begin{equation}
        \Gamma(s)\defs \left\{\gamma:Q\to P \mbox{ section : } 
        s = \frac{1}{\vol(Q)}\int_Q\gamma(x) \,\mathbb{d}x \right\}
        \end{equation}
    \end{definition}
    \begin{definition}
        Given $c\in(\RR^p)^\star$, let us define the following sets of sections:
        \begin{equation}
        \Gamma(\mathcal{F}^c) \defs 
        \left\{ \gamma\::\: \gamma(Q)\subseteq \bigcup_{F\in \mathcal{F}^c} F \right\}, \qquad
        \Gamma(\phi^c) \defs 
        \bigcup_{s\in\phi^c} \Gamma(s) 
        \end{equation}
    \end{definition}
    \begin{definition}
        Given $c\in(\RR^p)^\star$, we define the functional 
        $\mathcal{A}^c:\{\mbox{sections of } \pi \} \to \RR$ as:
        \begin{equation}
        \gamma \mapsto \mathcal{A}^c(\gamma) 
        \defs \frac1{\vol(Q)} \int_Q c(\gamma(x))\,\mbox{d}x
        \end{equation}
    \end{definition}
    \begin{theorem}
        Given $\gamma$ a section: 
        \begin{enumerate}
            \item $\gamma\in\Gamma(\mathcal{F}^c) 
            \implies  \mathcal{A}^c(\gamma) = 
            \min\limits_{\sigma \text{ section}}\mathcal{A}^c(\sigma)$
            (i.e., $\gamma$ minimizes $\mathcal{A}^c$).
            \item $\gamma\notin\Gamma(\mathcal{F}^c)
            \implies \exists \gamma^\prime : 
            \mathcal{A}^c(\gamma^\prime) < \mathcal{A}^c( \gamma)$.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \textcolor{white}{Avada Kedavra}
        
        $\boxed{1.}$
        
        First let us note that for all $r\in Q$, 
        the function $c$ has a minimum in $\pi^{-1}(r)$.
        \footnote{This is because $\pi^{-1}(r)$ is a polytope and $c$ is a linear function.}
        Also, it is clear that for any section $\sigma$
        \begin{equation}
        c(\sigma(r)) \geq c_0(r) \defs  \min_{y\in\pi^{-1}(r)}c(y),
        \end{equation}
        and therefore 
        $\mathcal{A}^c(\sigma) \geq \frac1{\vol(Q)}\int_Q c_0(x) \mathrm{ d}x$.
        If $\gamma\in \Gamma(\mathcal{F}^c)$, we know that $\forall r\in Q$,
        the point $\binom{r}{c(\gamma(r))}$ is in a lower face of $Q^c$. 
        If $c(\gamma(r))$ was not minimal in $\pi^{-1}(r)$, 
        we could find $y\in \pi^{-1}(r)$ such that $c(y) < c( \gamma(r))$.
        But since $y\in\pi^{-1}(r)$, this would produce a point $\binom{r}{c(y)}$.
        This is not possible because being the point in a lower face of $Q^c$ 
        and having the same in the first $q$ coordinates, 
        it cannot be that the last coordinate is decreased.
        
        $\boxed{2. }$
        
        Since $\gamma\notin\Gamma(\mathcal{F}^c)$, 
        there exists $r\in Q$ such that $\gamma(r)$ does not minimize $c$ in $\pi^{-1}(r)$. 
        Let $s \in \argmin\limits_{y\in\pi^{-1}(r)}\{c(y)\}$,
        Then we can define $v\defs s - \gamma(r)$. 
        By construction, we are in the hypothesis of \cref{lem:lemilla}, 
        so there exist an open neighbourhood $B\subseteq P$ of $\gamma(r)$ and $\eps > 0$,  such that
        $\gamma(r)\in B$ and $B+\eps v \subseteq P$. 
        Let us define $U \defs \gamma^{-1}(B)$.
        This set is open because $\gamma$ is continuous and $B$ is open.
        Then we define the function $f \colon \RR^q \to \RR$
        as a continuous function with the following properties:
        \footnote{This function can be constructed even to be infinitely differentiable
            with bump functions.}
        \begin{enumerate}
            \item For all $x\notin U$, satisfies $f(x) = 0$.
            \item For all $x\in U$, satisfies $0 \leq f(x) \leq \eps$.
            \item \label{itm:prova} Has positive integral: $\int_Q f(x) dx > 0$.
        \end{enumerate}
        
        Now let us define $\gamma^\prime\colon Q\to P$ as
        $\gamma^\prime(x) \defs \gamma(x) + vf(x)$.
        This is indeed a section because:
        \begin{enumerate}
            \item It is continuous, because $\gamma$ and $f$ are continuous.
            \item Since $\gamma(r),s\in \pi^{-1}(r)$, $v\in \ker \pi$, 
            and therefore 
            $\pi(\gamma^\prime(x)) = \pi(\gamma(x)) + \pi(vf(x)) = x + f(x)\pi(v) = x$. 
        \end{enumerate}
        
        Let us show now that $\mathcal{A}^c(\gamma^\prime) < \mathcal{A}^c(\gamma)$.
        \begin{equation}
        \mathcal{A}^c(\gamma^\prime) = 
        \frac1{\vol(Q)} \int_Q \left[c(\gamma(x)) + c(vf(x)) \right]\mathrm{ d}x = 
        \mathcal{A}^c(\gamma^\prime)  + \frac{c(v)}{\vol(Q)}\int_Q f(x)\mathrm{ d}x 
        \end{equation}
        Here using that $c(v) < 0$ and property \ref{itm:prova} in the definition of $f(x)$, 
        we get the desired inequality.
    \end{proof}
    
    \begin{corollary}
        \label{cor:gammaEquality}
        For all $c\in(\RR^p)^\star$, the identity $\Gamma(\mathcal{F}^c) = \Gamma(\phi^c)$ is satisfied.
    \end{corollary}
    \begin{proof}
        From the previous theorem, 
        we know that sections $\gamma$ that minimize $\mathcal A^c$ are precisely those satisfying $\gamma\in\mathcal{F}^c$. 
        For a section $\gamma$, let $s_\gamma\in\Sigma$ be the point it defines, 
        then $\gamma\in \Gamma(\phi^c) \iff c(s_\gamma) = \min_{y\in \Sigma}c(y) \iff \gamma$ minimizes $\mathcal{A}^c$.
    \end{proof}
    \begin{corollary}
        We have a poset isomorphism between $\omega_{coh}\cup \{\emptyset\}$ and the faces of $\Sigma$
        \footnote{As a convex set, we still have not proved that $\Sigma$ is a polytope.}.
    \end{corollary}
    \begin{proof}
        The bijection is clear with \cref{cor:gammaEquality}.
        Now let's see that it respects the partial order.
        Given $\mathcal{F}_1 \leq \mathcal{F}_2$. 
        By definition of the partial order, this means that 
        $\bigcup_{F\in\mathcal{F}_1} F \subset \bigcup_{F\in\mathcal{F}_2} F$.
        Therefore
        \begin{equation}
        \Gamma(\mathcal{F}_1) = \left\{ \gamma : \gamma(Q) \subseteq \bigcup_{F\in\mathcal{F}_1} F \subset \bigcup_{F\in\mathcal{F}_2} F \right\} 
        \subset  \Gamma(\mathcal{F}_2)
        \end{equation} 
        By \cref{cor:gammaEquality}, we have 
        $\Gamma(\phi_1) \subset \Gamma(\phi_2) \iff \phi_1 \subset \phi_2$.
        
    \end{proof}
    
    %This last theorem implies that, indeed $\Gamma(\mathcal{F}^c) = \Gamma(\phi^c)$,
    %which gives the desired bijection between the face lattice of $\Sigma$ and $\omega_{coh}$.
    
    Notice that because of this isomorphism we know that the face-lattice of $\Sigma$ has a finite number of elements. 
    Because of \cref{def:notYetKnownToBeFaces} this implies that there is also a finite number of inequalities that these faces satisfy as equalities, 
    and hence $\Sigma$ is a polytope.
    The identification of vertices with the tight $\pi$-coherent subdivisions of $Q$ 
    is made through \cite[Lemma 9.5]{ziegler2012lectures}, which concludes the proof.
    
    % Acaba la diversion
    
    \bibliographystyle{amsplain}
    \bibliography{bib}
    
\end{document}